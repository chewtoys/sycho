(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-242f2428"],{"2cee":function(e,t,a){},"5f23":function(e,t,a){"use strict";var i=a("2cee"),r=a.n(i);r.a},fbee:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"edit"},[a("div",{staticClass:"v-container"},[a("div",{staticClass:"v-header"},[a("el-row",[a("span",[e._v("标题：")]),a("el-input",{staticStyle:{width:"81.8%"},attrs:{placeholder:"请输入标题",clearable:""},model:{value:e.articleForm.title,callback:function(t){e.$set(e.articleForm,"title",t)},expression:"articleForm.title"}})],1),a("el-row",{staticStyle:{display:"flex","align-items":"center"}},[a("span",[e._v("描述：")]),a("el-input",{staticStyle:{width:"81.8%"},attrs:{placeholder:"请输入描述",type:"textarea",rows:2,clearable:""},model:{value:e.articleForm.desc,callback:function(t){e.$set(e.articleForm,"desc",t)},expression:"articleForm.desc"}})],1),a("el-row",{attrs:{type:"flex",align:"middle"}},[a("el-col",{attrs:{span:4}},[a("span",[e._v("作者：")]),a("el-input",{staticStyle:{width:"75%"},attrs:{placeholder:"请输入作者",clearable:""},model:{value:e.articleForm.author,callback:function(t){e.$set(e.articleForm,"author",t)},expression:"articleForm.author"}})],1),a("el-col",{attrs:{span:4}},[a("span",[e._v("分类：")]),a("el-select",{attrs:{clearable:"",placeholder:"请选择文章类别"},model:{value:e.articleForm.type,callback:function(t){e.$set(e.articleForm,"type",t)},expression:"articleForm.type"}},e._l(e.articleTypes,function(e,t){return a("el-option",{directives:[{name:"show",rawName:"v-show",value:0!==t,expression:"index !== 0"}],key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),a("el-col",{attrs:{span:13}},[a("span",[e._v("标签：")]),a("el-select",{staticStyle:{width:"90%"},attrs:{multiple:"",clearable:"",placeholder:"请选择文章标签"},model:{value:e.articleForm.tag,callback:function(t){e.$set(e.articleForm,"tag",t)},expression:"articleForm.tag"}},e._l(e.articleTags,function(e){return a("el-option",{directives:[{name:"show",rawName:"v-show",value:"0"!==e.value,expression:"item.value !== '0'"}],key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1),a("el-row",{attrs:{type:"flex",align:"middle"}},[a("el-col",{attrs:{span:4}},[a("span",[e._v("文章状态：")]),a("el-radio",{attrs:{label:"1"},model:{value:e.articleForm.state,callback:function(t){e.$set(e.articleForm,"state",t)},expression:"articleForm.state"}},[e._v("发布")]),a("el-radio",{attrs:{label:"2"},model:{value:e.articleForm.state,callback:function(t){e.$set(e.articleForm,"state",t)},expression:"articleForm.state"}},[e._v("草稿")])],1),a("el-col",{attrs:{span:4}},[a("span",[e._v("是否公开：")]),a("el-radio",{attrs:{label:"1"},model:{value:e.articleForm.publish,callback:function(t){e.$set(e.articleForm,"publish",t)},expression:"articleForm.publish"}},[e._v("公开")]),a("el-radio",{attrs:{label:"2"},model:{value:e.articleForm.publish,callback:function(t){e.$set(e.articleForm,"publish",t)},expression:"articleForm.publish"}},[e._v("私密")])],1),a("el-col",{attrs:{span:4}},[a("span",[e._v("点赞数：")]),a("el-input-number",{attrs:{min:0,max:1e8,label:"请输入点赞数","controls-position":"right"},model:{value:e.articleForm.meta.likes,callback:function(t){e.$set(e.articleForm.meta,"likes",t)},expression:"articleForm.meta.likes"}})],1),a("el-col",{attrs:{span:4}},[a("span",[e._v("吐槽数：")]),a("el-input-number",{attrs:{min:0,max:1e8,label:"请输入吐槽数","controls-position":"right"},model:{value:e.articleForm.meta.dislikes,callback:function(t){e.$set(e.articleForm.meta,"dislikes",t)},expression:"articleForm.meta.dislikes"}})],1),a("el-col",{attrs:{span:4}},[a("span",[e._v("浏览数：")]),a("el-input-number",{attrs:{min:0,max:1e8,label:"请输入浏览数","controls-position":"right"},model:{value:e.articleForm.meta.views,callback:function(t){e.$set(e.articleForm.meta,"views",t)},expression:"articleForm.meta.views"}})],1)],1),a("el-row",{attrs:{type:"flex",align:"middle"}},[a("el-col",{staticStyle:{display:"flex","align-items":"center"},attrs:{span:12}},[a("span",[e._v("缩略图：")]),a("el-upload",{staticClass:"avatar-uploader",attrs:{action:"","show-file-list":!1,accept:".jpg, .jpeg, .png",limit:1,"before-upload":e.beforeThumbUpload}},[e.articleForm.thumb?a("div",{class:["avatar-box",{hover:e.thumbImgHover}],on:{mouseenter:function(t){e.thumbImgHover=!0},mouseleave:function(t){e.thumbImgHover=!1}}},[a("img",{staticClass:"avatar",attrs:{src:e.articleForm.thumb}}),e.thumbImgHover?a("div",{staticClass:"imgHoverBtns"},[a("i",{staticClass:"el-icon-zoom-in",on:{click:function(t){t.stopPropagation(),e.thumbVisible=!0}}}),a("i",{staticClass:"el-icon-delete",on:{click:function(t){return t.stopPropagation(),e.handleThumbRemove(t)}}})]):e._e()]):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]),a("ul",{staticClass:"upload-tip"},[a("li",[e._v("每次只能上传1张图片。")]),a("li",[e._v("每张图片大小不超过 200kb。")]),a("li",[e._v("文件必须是 jpg 、png 或 jpeg 格式的图片。")])]),a("el-dialog",{attrs:{visible:e.thumbVisible,width:"35%"},on:{"update:visible":function(t){e.thumbVisible=t}}},[a("div",{staticStyle:{"text-align":"center"}},[a("img",{staticStyle:{display:"inline-block",width:"auto","max-width":"100%",height:"600px"},attrs:{src:e.articleForm.thumb,alt:""}})])])],1)],1)],1),a("div",{staticClass:"v-body"},[a("el-row",[a("tinymce",{attrs:{height:460},model:{value:e.articleForm.content,callback:function(t){e.$set(e.articleForm,"content",t)},expression:"articleForm.content"}})],1)],1),a("div",{staticClass:"v-footer"},[a("el-row",[a("el-button",{attrs:{type:"primary"},on:{click:e.handleSubmit}},[e._v("保存")])],1)],1)])])},r=[],l=(a("96cf"),a("3b8d")),s=(a("7f7f"),a("28a5"),a("cebc")),o=a("8256"),c=a("4397"),n=a("3438"),m=a.n(n),u={name:"edit",data:function(){var e=c["a"].articleTypes,t=c["a"].articleTags;return{articleTypes:e,articleTags:t,articleForm:{_id:"",title:"",desc:"",author:"",type:"",tag:[],state:"1",publish:"1",content:"",meta:{views:0,likes:0,dislikes:0,comments:0},thumb:""},cacheThumb:"",cos:null,fileObj:null,thumbVisible:!1,thumbImgHover:!1}},computed:{},created:function(){this._getArticleById()},mounted:function(){this.$nextTick(function(){})},destroyed:function(){},methods:{_getArticleById:function(){var e=this;this.$store.dispatch("article/getArticleById",{_id:this.$route.params.id}).then(function(t){t.success?(e.articleForm=Object(s["a"])({},t.data),e.cacheThumb=t.data.thumb,e.articleForm.tag=t.data.tag.split(","),e.articleForm.type=String(t.data.type),e.articleForm.state=String(t.data.state),e.articleForm.publish=String(t.data.publish)):e.$message({message:t.msg,type:"error"})})},beforeThumbUpload:function(e){return e.size>2e5?(this.$message.warning("文件".concat(e.name,"太大，不能超过 200kb")),!1):(this.articleForm.thumb=URL.createObjectURL(e),this.fileObj=e,!1)},handleThumbRemove:function(){this.articleForm.thumb="",this.fileObj=null},handleSubmit:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:this.checkArticle()&&(this.fileObj?this.$store.dispatch("cos/getSts",{}).then(function(e){if(e.success){var a=e.data;if(t.cos=new m.a({getAuthorization:function(e,t){t({TmpSecretId:a.credentials.tmpSecretId,TmpSecretKey:a.credentials.tmpSecretKey,XCosSecurityToken:a.credentials.sessionToken,ExpiredTime:a.expiredTime})}}),t.cacheThumb){var i=t.cacheThumb.split("/");t.cos.deleteObject({Bucket:"sycho1-1256277347",Region:"ap-guangzhou",Key:"/".concat(i[i.length-2],"/").concat(i[i.length-1])},function(e,a){var i=e||a;200===i.statusCode||204===i.statusCode?(t.articleForm.thumb="",t.handleUpdateThumb()):t.$message.error(i)})}else t.handleUpdateThumb()}}):this.handleUpdateForm());case 1:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),handleUpdateThumb:function(){var e=this;this.cos.putObject({Bucket:"sycho1-1256277347",Region:"ap-guangzhou",Key:"/article/".concat((new Date).getTime(),".").concat(this.fileObj.name.split(".")[1]),StorageClass:"STANDARD",Body:this.fileObj,onProgress:function(e){}},function(t,a){console.log(t||a),a.Location&&(e.articleForm.thumb="https://"+a.Location,e.handleUpdateForm())})},handleUpdateForm:function(){var e=this;this.$store.dispatch("article/putArticle",this.articleForm).then(function(t){t.success?(e.$message.success(t.msg),setTimeout(function(){e.$router.push({path:"/article/list"})},500)):e.$message.error(t.msg)})},checkArticle:function(){return this.articleForm.title.trim()?this.articleForm.desc.trim()?this.articleForm.author.trim()?this.articleForm.type?this.articleForm.tag.length?"undefined"===typeof this.articleForm.meta.likes?(this.$message.error("请输入点赞数"),!1):"undefined"===typeof this.articleForm.meta.dislikes?(this.$message.error("请输入吐槽数"),!1):"undefined"===typeof this.articleForm.meta.views?(this.$message.error("请输入浏览数"),!1):!!this.articleForm.content.trim()||(this.$message.error("请输入文章内容"),!1):(this.$message.error("请选择文章标签"),!1):(this.$message.error("请选择文章类型"),!1):(this.$message.error("请输入作者"),!1):(this.$message.error("请输入描述"),!1):(this.$message.error("请输入标题"),!1)}},components:{tinymce:o["a"]}},h=u,p=(a("5f23"),a("2877")),d=Object(p["a"])(h,i,r,!1,null,"ce511da4",null);t["default"]=d.exports}}]);
//# sourceMappingURL=chunk-242f2428.85566609.js.map