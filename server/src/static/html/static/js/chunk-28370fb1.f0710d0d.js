(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-28370fb1"],{a952:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"create"},[a("div",{staticClass:"v-container"},[a("div",{staticClass:"v-header"},[a("el-row",[a("span",[e._v("标题：")]),a("el-input",{staticStyle:{width:"81.8%"},attrs:{placeholder:"请输入标题",clearable:""},model:{value:e.articleForm.title,callback:function(t){e.$set(e.articleForm,"title",t)},expression:"articleForm.title"}})],1),a("el-row",{staticStyle:{display:"flex","align-items":"center"}},[a("span",[e._v("描述：")]),a("el-input",{staticStyle:{width:"81.8%"},attrs:{placeholder:"请输入描述",type:"textarea",rows:2,clearable:""},model:{value:e.articleForm.desc,callback:function(t){e.$set(e.articleForm,"desc",t)},expression:"articleForm.desc"}})],1),a("el-row",{attrs:{type:"flex",align:"middle"}},[a("el-col",{attrs:{span:4}},[a("span",[e._v("作者：")]),a("el-input",{staticStyle:{width:"75%"},attrs:{placeholder:"请输入作者",clearable:""},model:{value:e.articleForm.author,callback:function(t){e.$set(e.articleForm,"author",t)},expression:"articleForm.author"}})],1),a("el-col",{attrs:{span:4}},[a("span",[e._v("分类：")]),a("el-select",{attrs:{clearable:"",placeholder:"请选择文章类别"},model:{value:e.articleForm.type,callback:function(t){e.$set(e.articleForm,"type",t)},expression:"articleForm.type"}},e._l(e.articleTypes,function(e,t){return a("el-option",{directives:[{name:"show",rawName:"v-show",value:0!==t,expression:"index !== 0"}],key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),a("el-col",{attrs:{span:13}},[a("span",[e._v("标签：")]),a("el-select",{staticStyle:{width:"90%"},attrs:{multiple:"",clearable:"",placeholder:"请选择文章标签"},model:{value:e.articleForm.tag,callback:function(t){e.$set(e.articleForm,"tag",t)},expression:"articleForm.tag"}},e._l(e.articleTags,function(e){return a("el-option",{directives:[{name:"show",rawName:"v-show",value:"0"!==e.value,expression:"item.value !== '0'"}],key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1),a("el-row",{attrs:{type:"flex",align:"middle"}},[a("el-col",{attrs:{span:4}},[a("span",[e._v("文章状态：")]),a("el-radio",{attrs:{label:"1"},model:{value:e.articleForm.state,callback:function(t){e.$set(e.articleForm,"state",t)},expression:"articleForm.state"}},[e._v("发布")]),a("el-radio",{attrs:{label:"2"},model:{value:e.articleForm.state,callback:function(t){e.$set(e.articleForm,"state",t)},expression:"articleForm.state"}},[e._v("草稿")])],1),a("el-col",{attrs:{span:4}},[a("span",[e._v("是否公开：")]),a("el-radio",{attrs:{label:"1"},model:{value:e.articleForm.publish,callback:function(t){e.$set(e.articleForm,"publish",t)},expression:"articleForm.publish"}},[e._v("公开")]),a("el-radio",{attrs:{label:"2"},model:{value:e.articleForm.publish,callback:function(t){e.$set(e.articleForm,"publish",t)},expression:"articleForm.publish"}},[e._v("私密")])],1),a("el-col",{attrs:{span:4}},[a("span",[e._v("点赞数：")]),a("el-input-number",{attrs:{min:0,max:1e8,label:"请输入点赞数","controls-position":"right"},on:{change:e.handleChange},model:{value:e.articleForm.meta.likes,callback:function(t){e.$set(e.articleForm.meta,"likes",t)},expression:"articleForm.meta.likes"}})],1),a("el-col",{attrs:{span:4}},[a("span",[e._v("吐槽数：")]),a("el-input-number",{attrs:{min:0,max:1e8,label:"请输入吐槽数","controls-position":"right"},on:{change:e.handleChange},model:{value:e.articleForm.meta.dislikes,callback:function(t){e.$set(e.articleForm.meta,"dislikes",t)},expression:"articleForm.meta.dislikes"}})],1),a("el-col",{attrs:{span:4}},[a("span",[e._v("浏览数：")]),a("el-input-number",{attrs:{min:0,max:1e8,label:"请输入浏览数","controls-position":"right"},on:{change:e.handleChange},model:{value:e.articleForm.meta.views,callback:function(t){e.$set(e.articleForm.meta,"views",t)},expression:"articleForm.meta.views"}})],1)],1),a("el-row",{attrs:{type:"flex",align:"middle"}},[a("el-col",{staticStyle:{display:"flex","align-items":"center"},attrs:{span:12}},[a("span",[e._v("缩略图：")]),a("el-upload",{staticClass:"avatar-uploader",attrs:{action:"","show-file-list":!1,accept:".jpg, .jpeg, .png",limit:1,"before-upload":e.beforeThumbUpload}},[e.articleForm.thumb?a("div",{class:["avatar-box",{hover:e.thumbImgHover}],on:{mouseenter:function(t){e.thumbImgHover=!0},mouseleave:function(t){e.thumbImgHover=!1}}},[a("img",{staticClass:"avatar",attrs:{src:e.articleForm.thumb}}),e.thumbImgHover?a("div",{staticClass:"imgHoverBtns"},[a("i",{staticClass:"el-icon-zoom-in",on:{click:function(t){t.stopPropagation(),e.thumbVisible=!0}}}),a("i",{staticClass:"el-icon-delete",on:{click:function(t){return t.stopPropagation(),e.handleThumbRemove(t)}}})]):e._e()]):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]),a("ul",{staticClass:"upload-tip"},[a("li",[e._v("每次只能上传1张图片。")]),a("li",[e._v("每张图片大小不超过 200kb。")]),a("li",[e._v("文件必须是 jpg 、png 或 jpeg 格式的图片。")])]),a("el-dialog",{attrs:{visible:e.thumbVisible,width:"35%"},on:{"update:visible":function(t){e.thumbVisible=t}}},[a("div",{staticStyle:{"text-align":"center"}},[a("img",{staticStyle:{display:"inline-block",width:"auto","max-width":"100%",height:"600px"},attrs:{src:e.articleForm.thumb,alt:""}})])])],1)],1)],1),a("div",{staticClass:"v-body"},[a("el-row",[a("tinymce",{attrs:{height:460},model:{value:e.articleForm.content,callback:function(t){e.$set(e.articleForm,"content",t)},expression:"articleForm.content"}})],1)],1),a("div",{staticClass:"v-footer"},[a("el-row",[a("el-button",{attrs:{type:"primary"},on:{click:e.handleSubmit}},[e._v("保存")])],1)],1)])])},l=[],s=(a("28a5"),a("7f7f"),a("8256")),r=a("4397"),o=a("3438"),c=a.n(o),n={name:"create",data:function(){var e=r["a"].articleTypes,t=r["a"].articleTags;return{articleTypes:e,articleTags:t,articleForm:{title:"",desc:"",author:"admin",type:"",tag:[],state:"1",publish:"1",content:"",meta:{views:0,likes:0,dislikes:0,comments:0},thumb:""},cos:null,thumbVisible:!1,thumbImgHover:!1}},computed:{},created:function(){},mounted:function(){},destroyed:function(){},methods:{handleChange:function(){},handleThumbRemove:function(){this.articleForm.thumb="",this.fileObj=null},beforeThumbUpload:function(e){return e.size>2e5?(this.$message.warning("文件".concat(e.name,"太大，不能超过 200kb")),!1):(this.articleForm.thumb=URL.createObjectURL(e),this.fileObj=e,!1)},handleSubmit:function(){var e=this;this.checkArticle()&&(this.fileObj?this.$store.dispatch("cos/getSts",{}).then(function(t){if(t.success){var a=t.data;e.cos=new c.a({getAuthorization:function(e,t){t({TmpSecretId:a.credentials.tmpSecretId,TmpSecretKey:a.credentials.tmpSecretKey,XCosSecurityToken:a.credentials.sessionToken,ExpiredTime:a.expiredTime})}}),e.thumbParams={Bucket:a.bucket,Region:a.region,Key:"/".concat(a.dir,"/").concat((new Date).getTime(),".").concat(e.fileObj.name.split(".")[1])},e.cos.putObject({Bucket:a.bucket,Region:a.region,Key:"/".concat(a.dir,"/").concat((new Date).getTime(),".").concat(e.fileObj.name.split(".")[1]),StorageClass:"STANDARD",Body:e.fileObj,onProgress:function(e){}},function(t,a){console.log(t||a),e.articleForm.thumb="https://"+a.Location,e.handlePostArticle()})}else console.log(t)}):this.handlePostArticle())},handlePostArticle:function(){var e=this;this.$store.dispatch("article/postArticle",this.articleForm).then(function(t){t.success?(e.$message.success("发布成功！"),setTimeout(function(){e.$router.push({path:"/article/list"})},500)):e.$message.error(t.msg)})},checkArticle:function(){return this.articleForm.title.trim()?this.articleForm.desc.trim()?this.articleForm.author.trim()?this.articleForm.type?this.articleForm.tag.length?"undefined"===typeof this.articleForm.meta.likes?(this.$message.error("请输入点赞数"),!1):"undefined"===typeof this.articleForm.meta.dislikes?(this.$message.error("请输入吐槽数"),!1):"undefined"===typeof this.articleForm.meta.views?(this.$message.error("请输入浏览数"),!1):!!this.articleForm.content.trim()||(this.$message.error("请输入文章内容"),!1):(this.$message.error("请选择文章标签"),!1):(this.$message.error("请选择文章类型"),!1):(this.$message.error("请输入作者"),!1):(this.$message.error("请输入描述"),!1):(this.$message.error("请输入标题"),!1)}},components:{tinymce:s["a"]}},m=n,u=(a("f40c"),a("2877")),p=Object(u["a"])(m,i,l,!1,null,"03f0e3bd",null);t["default"]=p.exports},bc63:function(e,t,a){},f40c:function(e,t,a){"use strict";var i=a("bc63"),l=a.n(i);l.a}}]);
//# sourceMappingURL=chunk-28370fb1.f0710d0d.js.map