(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7f1a874a"],{"3f95":function(e,r,a){"use strict";var t=a("7cda"),l=a.n(t);l.a},4397:function(e,r,a){"use strict";var t={linkTypes:[{value:"0",label:"全部"},{value:"1",label:"技术"},{value:"2",label:"生活"},{value:"3",label:"购物"},{value:"4",label:"前端"},{value:"6",label:"小程序"},{value:"7",label:"后端"},{value:"8",label:"友链"},{value:"9",label:"个人项目"}],userTypes:[{value:"0",label:"全部"},{value:"1",label:"用户"},{value:"2",label:"管理员"},{value:"3",label:"超级管理员"}],articleTypes:[{value:"0",label:"全部"},{value:"1",label:"技术"},{value:"2",label:"生活"}],articleTags:[{value:"0",label:"全部"},{value:"1",label:"css3"},{value:"2",label:"sass/less"},{value:"3",label:"html5"},{value:"4",label:"javascript"},{value:"5",label:"es6"},{value:"6",label:"canvas"},{value:"7",label:"pixijs"},{value:"8",label:"createjs"},{value:"9",label:"vue"},{value:"10",label:"vuex"},{value:"11",label:"vue-router"},{value:"12",label:"nuxt"},{value:"13",label:"微信小程序"},{value:"14",label:"wepy"},{value:"15",label:"uniapp"},{value:"16",label:"hybird app"},{value:"17",label:"nginx"},{value:"18",label:"webpack"},{value:"19",label:"express"},{value:"20",label:"koa2"},{value:"21",label:"nodejs"},{value:"22",label:"mongodb"}]};r["a"]=t},"7cda":function(e,r,a){},e382:function(e,r,a){"use strict";a.r(r);var t=function(){var e=this,r=e.$createElement,a=e._self._c||r;return a("div",{staticClass:"user"},[a("el-row",{staticClass:"header",attrs:{type:"flex",justify:"space-between"}},[a("el-col",{attrs:{span:4}},[a("el-input",{attrs:{placeholder:"请输入内容",clearable:""},model:{value:e.keyword,callback:function(r){e.keyword=r},expression:"keyword"}})],1),a("el-col",{attrs:{span:4}},[a("el-select",{staticStyle:{display:"block"},attrs:{placeholder:"请选择权限类型",clearable:""},model:{value:e.role,callback:function(r){e.role=r},expression:"role"}},e._l(e.userTypes,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),a("el-col",{attrs:{span:16}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-search",round:""},on:{click:e._getUser}},[e._v("搜索")]),a("el-button",{attrs:{type:"primary",icon:"el-icon-plus",round:""},on:{click:e.handleAdd}},[e._v("新增")])],1)],1),a("el-row",{staticClass:"content"},[a("el-col",{attrs:{span:24}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"",height:"560",stripe:"",fit:"","highlight-current-row":"","default-sort":{prop:"createTime",order:"descending"}}},[a("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"50"}}),a("el-table-column",{attrs:{prop:"username",label:"昵称",align:"center",width:"180"}}),a("el-table-column",{attrs:{prop:"username",label:"用户名",align:"center",width:"180"}}),a("el-table-column",{attrs:{prop:"role",label:"角色类型",formatter:e.formatterRole,align:"center",width:"180"}}),a("el-table-column",{attrs:{prop:"avatar",label:"头像",align:"center",width:"220"},scopedSlots:e._u([{key:"default",fn:function(r){return[a("img",{staticStyle:{width:"auto","max-width":"100%","max-height":"60px"},attrs:{src:e.reUrl+r.row.avatar,alt:""}})]}}])}),a("el-table-column",{attrs:{prop:"desc",align:"center",label:"角色描述"}}),a("el-table-column",{attrs:{sortable:"",align:"center",label:"创建时间"},scopedSlots:e._u([{key:"default",fn:function(r){return[e._v("\n            "+e._s(e._f("formatterTime")(r.row.createDate))+"\n          ")]}}])}),a("el-table-column",{attrs:{sortable:"",align:"center",label:"更新时间"},scopedSlots:e._u([{key:"default",fn:function(r){return[e._v("\n            "+e._s(e._f("formatterTime")(r.row.updateDate))+"\n          ")]}}])}),a("el-table-column",{attrs:{fixed:"right",label:"操作",align:"center",width:"160"},scopedSlots:e._u([{key:"default",fn:function(r){return[a("el-button",{attrs:{type:"text",size:"small",icon:"el-icon-edit"},on:{click:function(a){return e.handleEdit(r.row)}}},[e._v("编辑")]),a("el-button",{attrs:{type:"text",size:"small",icon:"el-icon-delete"},on:{click:function(a){return e.handleDelete(r.row)}}},[e._v("删除")])]}}])})],1),a("el-pagination",{attrs:{"current-page":e.currentPage,"page-size":e.pageSize,total:e.total,"page-sizes":[10,30,50,100],layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1),a("el-dialog",{attrs:{title:1===e.dialogType?"新增":"编辑",visible:e.dialogVisible,width:"30%","close-on-click-modal":!1},on:{"update:visible":function(r){e.dialogVisible=r}}},[a("el-form",{ref:"userForm",attrs:{model:e.userForm,rules:e.userFormRules,"status-icon":"","label-width":"80px","close-on-click-modal":!1}},[a("el-form-item",{attrs:{label:"用户名",required:"",prop:"username",autocomplete:"off"}},[a("el-input",{attrs:{placeholder:"请输入用户名",clearable:""},model:{value:e.userForm.username,callback:function(r){e.$set(e.userForm,"username",r)},expression:"userForm.username"}})],1),1===e.dialogType?a("el-form-item",{attrs:{label:"密码",required:"",prop:"curPwd",autocomplete:"off"}},[a("el-input",{attrs:{type:"password",placeholder:"请输入密码",clearable:""},model:{value:e.userForm.curPwd,callback:function(r){e.$set(e.userForm,"curPwd",r)},expression:"userForm.curPwd"}})],1):e._e(),1===e.dialogType?a("el-form-item",{attrs:{label:"确认密码",required:"",prop:"surePwd"}},[a("el-input",{attrs:{type:"password",placeholder:"请再次输入密码",clearable:""},model:{value:e.userForm.surePwd,callback:function(r){e.$set(e.userForm,"surePwd",r)},expression:"userForm.surePwd"}})],1):e._e(),2===e.dialogType?a("el-form-item",{attrs:{label:"原始密码",prop:"prePwd",autocomplete:"off"}},[a("el-input",{attrs:{type:"password",placeholder:"请输入原始密码",clearable:""},model:{value:e.userForm.prePwd,callback:function(r){e.$set(e.userForm,"prePwd",r)},expression:"userForm.prePwd"}})],1):e._e(),2===e.dialogType?a("el-form-item",{attrs:{label:"新密码",prop:"newPwd"}},[a("el-input",{attrs:{type:"password",placeholder:"请输入新密码",clearable:""},model:{value:e.userForm.newPwd,callback:function(r){e.$set(e.userForm,"newPwd",r)},expression:"userForm.newPwd"}})],1):e._e(),2===e.dialogType?a("el-form-item",{attrs:{label:"确认密码",prop:"confirmPwd"}},[a("el-input",{attrs:{type:"password",placeholder:"请再次输入新密码",clearable:""},model:{value:e.userForm.confirmPwd,callback:function(r){e.$set(e.userForm,"confirmPwd",r)},expression:"userForm.confirmPwd"}})],1):e._e(),a("el-form-item",{attrs:{label:"角色",required:"",prop:"role"}},[a("el-select",{staticStyle:{display:"block"},attrs:{placeholder:"请选择角色权限类型",clearable:""},model:{value:e.userForm.role,callback:function(r){e.$set(e.userForm,"role",r)},expression:"userForm.role"}},e._l(e.userTypes,function(e,r){return a("el-option",{directives:[{name:"show",rawName:"v-show",value:0!==r,expression:"index !== 0"}],key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),a("el-form-item",{attrs:{label:"描述",required:"",prop:"desc"}},[a("el-input",{attrs:{placeholder:"请输入描述",clearable:""},model:{value:e.userForm.desc,callback:function(r){e.$set(e.userForm,"desc",r)},expression:"userForm.desc"}})],1),a("el-form-item",{attrs:{label:"头像"}},[a("div",{staticClass:"upload-box"},[a("el-upload",{attrs:{action:"","auto-upload":!0,"show-file-list":!1,accept:".jpg, .jpeg, .png",limit:1,"before-upload":e.beforeAvatarUpload}},[e.avatarImgUrl?a("div",{class:["avatar-box",{hover:e.avatarImgHover}],on:{mouseenter:function(r){e.avatarImgHover=!0},mouseleave:function(r){e.avatarImgHover=!1}}},[a("img",{staticClass:"avatar",attrs:{src:e.avatarImgUrl}}),e.avatarImgHover?a("div",{staticClass:"imgHoverBtns"},[a("i",{staticClass:"el-icon-zoom-in",on:{click:function(r){r.stopPropagation(),e.avatarVisible=!0}}}),a("i",{staticClass:"el-icon-delete",on:{click:function(r){return r.stopPropagation(),e.handleRemoveAvatar(r)}}})]):e._e()]):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]),a("ul",{staticClass:"upload-tip"},[a("li",[e._v("每次只能上传1张图片。")]),a("li",[e._v("每张图片大小不超过 200kb。")]),a("li",[e._v("文件必须是 jpg 、png 或 jpeg 格式的图片。")])]),a("el-dialog",{attrs:{visible:e.avatarVisible,width:"35%","append-to-body":""},on:{"update:visible":function(r){e.avatarVisible=r}}},[a("div",{staticStyle:{"text-align":"center"}},[a("img",{staticStyle:{display:"inline-block",width:"auto","max-width":"100%",height:"600px"},attrs:{src:e.avatarImgUrl,alt:""}})])])],1)])],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(r){e.dialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.handleSubmitForm}},[e._v("确 定")])],1)],1)],1)},l=[],s=(a("7f7f"),a("cebc")),o=a("75fc"),i=a("4397"),n=a("393b"),u={name:"user",data:function(){var e=this,r=function(r,a,t){""===a||"undefined"===typeof a?t(new Error("请输入密码")):a.length<6?t(new Error("密码不能少于6位")):e.userForm.surePwd?t():(e.$refs.userForm.validateField("surePwd"),t())},a=function(r,a,t){""===a||"undefined"===typeof a?t(new Error("请再次输入密码")):a.length<6?t(new Error("密码不能少于6位")):a!==e.userForm.curPwd?t(new Error("两次密码输入不一致!")):t()},t=function(r,a,t){e.userForm.newPwd||e.userForm.prePwd||e.userForm.confirmPwd?""===a||"undefined"===typeof a?t(new Error("请输入原始密码")):a.length<6?t(new Error("密码不能少于6位")):(e.userForm.newPwd?e.userForm.confirmPwd||e.$refs.userForm.validateField("confirmPwd"):e.$refs.userForm.validateField("newPwd"),t()):t()},l=function(r,a,t){e.userForm.newPwd||e.userForm.prePwd||e.userForm.confirmPwd?""===a||"undefined"===typeof a?t(new Error("请输入新密码")):a.length<6?t(new Error("密码不能少于6位")):(e.$refs.userForm.validateField("confirmPwd"),t()):t()},s=function(r,a,t){e.userForm.newPwd||e.userForm.prePwd||e.userForm.confirmPwd?""===a||"undefined"===typeof a?t(new Error("请再次输入密码")):a.length<6?t(new Error("密码不能少于6位")):e.userForm.newPwd?a!==e.userForm.newPwd?t(new Error("两次密码输入不一致!")):(e.userForm.prePwd||e.$refs.userForm.validateField("prePwd"),t()):(e.$refs.userForm.validateField("newPwd"),t()):t()},o=i["a"].userTypes;return{keyword:"",userTypes:o,role:"",tableData:[],userForm:{_id:"",username:"",curPwd:"",surePwd:"",prePwd:"",newPwd:"",confirmPwd:"",role:"",desc:""},userFormRules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"},{required:!0,message:"请输入用户名",trigger:"change"}],curPwd:[{validator:r,trigger:"blur"},{validator:r,trigger:"change"}],surePwd:[{validator:a,trigger:"blur"},{validator:a,trigger:"change"}],prePwd:[{validator:t,trigger:"change"}],newPwd:[{validator:l,trigger:"change"}],confirmPwd:[{validator:s,trigger:"change"}],role:[{required:!0,message:"请选择用户角色",trigger:"change"}],desc:[{required:!0,message:"请输入用户描述",trigger:"blur"},{required:!0,message:"请输入用户描述",trigger:"change"}]},currentPage:1,pageSize:10,total:0,loading:!1,dialogVisible:!1,dialogType:1,fileObj:null,avatarImgUrl:"",avatarVisible:!1,avatarImgHover:!1}},created:function(){this._getUser()},filters:{formatterTime:n["a"]},methods:{handleRemoveAvatar:function(){this.avatarImgUrl=""},formatterRole:function(e,r,a,t){return"1"===a?"用户":"2"===a?"管理员":"3"===a?"超级管理员":void 0},_getUser:function(){var e=this;this.loading=!0,this.$store.dispatch("user/getUser",{currentPage:this.currentPage,pageSize:this.pageSize,keyword:this.keyword,role:this.role}).then(function(r){r.success?(e.tableData=Object(o["a"])(r.data.list),e.total=r.data.pagination.total,e.pageSize=r.data.pagination.pageSize,e.currentPage=r.data.pagination.currentPage):e.$message.error(r.msg)}).then(function(){e.loading=!1})},handleSizeChange:function(e){this.pageSize=e,this._getUser()},handleCurrentChange:function(e){this.currentPage=e,this._getUser()},handleClick:function(e){console.log(e)},handleAdd:function(){var e=this;this.userForm=Object.assign({},{_id:"",username:"",curPwd:"",prePwd:"",newPwd:"",confirmPwd:"",role:"",desc:""}),this.avatarImgUrl="",this.$nextTick(function(){e.$refs["userForm"].clearValidate()}),this.dialogType=1,this.dialogVisible=!0},handleEdit:function(e){var r=this;this.userForm=Object(s["a"])({},e),this.avatarImgUrl="".concat(this.reUrl).concat(e.avatar),this.$nextTick(function(){r.$refs["userForm"].clearValidate()}),this.dialogType=2,this.dialogVisible=!0},handleSubmitForm:function(){var e=this;this.$refs.userForm.validate(function(r){if(r){var a=new FormData;a.append("file",e.fileObj),a.append("username",e.userForm.username),a.append("role",e.userForm.role),a.append("desc",e.userForm.desc);var t="";e.userForm._id?(t="user/putUser",a.append("_id",e.userForm._id),e.userForm.prePwd&&(a.append("prePwd",e.userForm.prePwd),a.append("newPwd",e.userForm.newPwd),a.append("surePwd",e.userForm.confirmPwd))):(t="user/postUser",a.append("curPwd",e.userForm.curPwd),a.append("surePwd",e.userForm.surePwd)),e.$store.dispatch(t,a).then(function(r){r.success?(e.fileObj=null,e.dialogVisible=!1,e.$message({message:r.msg,type:"success"}),e._getUser()):e.$message({message:r.msg,type:"error"})})}})},handleDelete:function(e){var r=this;this.$confirm("此操作将删除该行, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){r.$store.dispatch("user/deleteUser",e._id).then(function(e){e.success?(r.$message.success(e.msg),r._getUser()):r.$message.error(e.msg)})}).catch(function(){console.log("取消删除")})},beforeAvatarUpload:function(e){return e.size>2e5?(this.$message({message:"文件".concat(e.name,"太大，不能超过 200kb"),type:"warning"}),!1):(console.log(e),this.avatarImgUrl=URL.createObjectURL(e),this.fileObj=e,!1)}}},c=u,d=(a("3f95"),a("2877")),p=Object(d["a"])(c,t,l,!1,null,"3f67c472",null);r["default"]=p.exports}}]);
//# sourceMappingURL=chunk-7f1a874a.5c67bfdf.js.map