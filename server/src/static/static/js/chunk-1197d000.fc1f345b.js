(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1197d000"],{"035f":function(e,a,r){"use strict";var l=r("e844"),t=r.n(l);t.a},4397:function(e,a,r){"use strict";var l={linkTypes:[{value:"0",label:"全部"},{value:"1",label:"技术"},{value:"2",label:"生活"},{value:"3",label:"购物"},{value:"4",label:"前端"},{value:"6",label:"小程序"},{value:"7",label:"后端"},{value:"8",label:"友链"},{value:"9",label:"个人项目"}],userTypes:[{value:"0",label:"全部"},{value:"1",label:"用户"},{value:"2",label:"管理员"},{value:"3",label:"超级管理员"}],articleTypes:[{value:"0",label:"全部"},{value:"1",label:"技术"},{value:"2",label:"生活"}],articleTags:[{value:"0",label:"全部"},{value:"1",label:"css3"},{value:"2",label:"sass/less"},{value:"3",label:"html5"},{value:"4",label:"javascript"},{value:"5",label:"es6"},{value:"6",label:"canvas"},{value:"7",label:"pixijs"},{value:"8",label:"createjs"},{value:"9",label:"vue"},{value:"10",label:"vuex"},{value:"11",label:"vue-router"},{value:"12",label:"nuxt"},{value:"13",label:"微信小程序"},{value:"14",label:"wepy"},{value:"15",label:"uniapp"},{value:"16",label:"hybird app"},{value:"17",label:"nginx"},{value:"18",label:"webpack"},{value:"19",label:"express"},{value:"20",label:"koa2"},{value:"21",label:"nodejs"},{value:"22",label:"mongodb"},{value:"23",label:"人生"},{value:"24",label:"随记"},{value:"25",label:"情感"},{value:"26",label:"生活"},{value:"27",label:"工作"},{value:"28",label:"旅游"},{value:"29",label:"烹饪"},{value:"30",label:"运动"},{value:"31",label:"电影"},{value:"32",label:"音乐"},{value:"33",label:"游戏"},{value:"34",label:"吃喝玩乐"}]};a["a"]=l},e382:function(e,a,r){"use strict";r.r(a);var l=function(){var e=this,a=e.$createElement,r=e._self._c||a;return r("div",{staticClass:"user"},[r("el-row",{staticClass:"header",attrs:{type:"flex",justify:"space-between",gutter:10}},[r("el-col",{attrs:{xs:12,sm:6,md:6,lg:6,xl:4}},[r("el-input",{attrs:{placeholder:"请输入内容",clearable:"",size:"small"},model:{value:e.keyword,callback:function(a){e.keyword=a},expression:"keyword"}})],1),r("el-col",{attrs:{xs:12,sm:6,md:6,lg:6,xl:4}},[r("el-select",{staticStyle:{display:"block"},attrs:{placeholder:"请选择权限类型",clearable:"",size:"small"},model:{value:e.role,callback:function(a){e.role=a},expression:"role"}},e._l(e.userTypes,function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e.winWidth>500?r("el-col",{attrs:{xs:24,sm:12,md:12,lg:12,xl:16}},[r("el-button",{attrs:{type:"primary",icon:"el-icon-search",round:"",size:"small"},on:{click:e._getUser}},[e._v("搜索")]),r("el-button",{attrs:{type:"primary",icon:"el-icon-plus",round:"",size:"small"},on:{click:e.handleAdd}},[e._v("新增")])],1):e._e()],1),e.winWidth<=500?r("el-row",{staticStyle:{padding:"0 10px"},attrs:{type:"flex",justify:"end"}},[r("el-button",{attrs:{type:"primary",icon:"el-icon-search",round:"",size:"small"},on:{click:e._getUser}},[e._v("搜索")]),r("el-button",{attrs:{type:"primary",icon:"el-icon-plus",round:"",size:"small"},on:{click:e.handleAdd}},[e._v("新增")])],1):e._e(),r("el-row",{staticClass:"content"},[r("el-col",{attrs:{span:24}},[r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"",height:"560",stripe:"",fit:"","highlight-current-row":"","default-sort":{prop:"createTime",order:"descending"},size:"small"}},[r("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"50"}}),r("el-table-column",{attrs:{prop:"username",label:"昵称",align:"center",width:"180"}}),r("el-table-column",{attrs:{prop:"username",label:"用户名",align:"center",width:"180"}}),r("el-table-column",{attrs:{prop:"role",label:"角色类型",formatter:e.formatterRole,align:"center",width:"180"}}),r("el-table-column",{attrs:{prop:"avatar",label:"头像",align:"center",width:"220"},scopedSlots:e._u([{key:"default",fn:function(a){return[r("img",{staticStyle:{width:"auto","max-width":"100%","max-height":"60px"},attrs:{src:e.reUrl+a.row.avatar,alt:""}})]}}])}),r("el-table-column",{attrs:{prop:"desc",align:"center",label:"角色描述"}}),r("el-table-column",{attrs:{sortable:"",align:"center",label:"创建时间"},scopedSlots:e._u([{key:"default",fn:function(a){return[e._v("\n            "+e._s(e._f("formatterTime")(a.row.createDate))+"\n          ")]}}])}),r("el-table-column",{attrs:{sortable:"",align:"center",label:"更新时间"},scopedSlots:e._u([{key:"default",fn:function(a){return[e._v("\n            "+e._s(e._f("formatterTime")(a.row.updateDate))+"\n          ")]}}])}),r("el-table-column",{attrs:{label:"操作",align:"center",width:"160"},scopedSlots:e._u([{key:"default",fn:function(a){return[r("el-button",{attrs:{type:"text",size:"small",icon:"el-icon-edit"},on:{click:function(r){return e.handleEdit(a.row)}}},[e._v("编辑")]),r("el-button",{attrs:{type:"text",size:"small",icon:"el-icon-delete"},on:{click:function(r){return e.handleDelete(a.row)}}},[e._v("删除")])]}}])})],1),r("el-pagination",{attrs:{"current-page":e.currentPage,"page-size":e.pageSize,total:e.total,"page-sizes":[10,30,50,100],layout:"total, sizes, prev, pager, next"},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1),r("el-dialog",{attrs:{title:1===e.dialogType?"新增":"编辑",visible:e.dialogVisible,width:e.winWidth<500?"96%":e.winWidth<1200?"66%":"30%","close-on-click-modal":!1},on:{"update:visible":function(a){e.dialogVisible=a}}},[r("el-form",{ref:"userForm",attrs:{model:e.userForm,rules:e.userFormRules,"status-icon":"","label-width":"80px","close-on-click-modal":!1}},[r("el-form-item",{attrs:{label:"用户名",required:"",prop:"username",autocomplete:"off"}},[r("el-input",{attrs:{placeholder:"请输入用户名",clearable:"",size:"small"},model:{value:e.userForm.username,callback:function(a){e.$set(e.userForm,"username",a)},expression:"userForm.username"}})],1),1===e.dialogType?r("el-form-item",{attrs:{label:"密码",required:"",prop:"curPwd",autocomplete:"off"}},[r("el-input",{attrs:{type:"password",placeholder:"请输入密码",clearable:"",size:"small"},model:{value:e.userForm.curPwd,callback:function(a){e.$set(e.userForm,"curPwd",a)},expression:"userForm.curPwd"}})],1):e._e(),1===e.dialogType?r("el-form-item",{attrs:{label:"确认密码",required:"",prop:"surePwd"}},[r("el-input",{attrs:{type:"password",placeholder:"请再次输入密码",clearable:"",size:"small"},model:{value:e.userForm.surePwd,callback:function(a){e.$set(e.userForm,"surePwd",a)},expression:"userForm.surePwd"}})],1):e._e(),2===e.dialogType?r("el-form-item",{attrs:{label:"原始密码",prop:"prePwd",autocomplete:"off"}},[r("el-input",{attrs:{type:"password",placeholder:"请输入原始密码",clearable:"",size:"small"},model:{value:e.userForm.prePwd,callback:function(a){e.$set(e.userForm,"prePwd",a)},expression:"userForm.prePwd"}})],1):e._e(),2===e.dialogType?r("el-form-item",{attrs:{label:"新密码",prop:"newPwd"}},[r("el-input",{attrs:{type:"password",placeholder:"请输入新密码",clearable:"",size:"small"},model:{value:e.userForm.newPwd,callback:function(a){e.$set(e.userForm,"newPwd",a)},expression:"userForm.newPwd"}})],1):e._e(),2===e.dialogType?r("el-form-item",{attrs:{label:"确认密码",prop:"confirmPwd"}},[r("el-input",{attrs:{type:"password",placeholder:"请再次输入新密码",clearable:"",size:"small"},model:{value:e.userForm.confirmPwd,callback:function(a){e.$set(e.userForm,"confirmPwd",a)},expression:"userForm.confirmPwd"}})],1):e._e(),r("el-form-item",{attrs:{label:"角色",required:"",prop:"role"}},[r("el-select",{staticStyle:{display:"block"},attrs:{placeholder:"请选择角色权限类型",clearable:"",size:"small"},model:{value:e.userForm.role,callback:function(a){e.$set(e.userForm,"role",a)},expression:"userForm.role"}},e._l(e.userTypes,function(e,a){return r("el-option",{directives:[{name:"show",rawName:"v-show",value:0!==a,expression:"index !== 0"}],key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),r("el-form-item",{attrs:{label:"描述",required:"",prop:"desc"}},[r("el-input",{attrs:{placeholder:"请输入描述",clearable:"",size:"small"},model:{value:e.userForm.desc,callback:function(a){e.$set(e.userForm,"desc",a)},expression:"userForm.desc"}})],1),r("el-form-item",{attrs:{label:"头像"}},[r("div",{staticClass:"upload-box"},[r("el-upload",{attrs:{action:"","auto-upload":!0,"show-file-list":!1,accept:".jpg, .jpeg, .png",limit:1,"before-upload":e.beforeAvatarUpload}},[e.avatarImgUrl?r("div",{class:["avatar-box",{hover:e.avatarImgHover}],on:{mouseenter:function(a){e.avatarImgHover=!0},mouseleave:function(a){e.avatarImgHover=!1}}},[r("img",{staticClass:"avatar",attrs:{src:e.avatarImgUrl}}),e.avatarImgHover?r("div",{staticClass:"imgHoverBtns"},[r("i",{staticClass:"el-icon-zoom-in",on:{click:function(a){a.stopPropagation(),e.avatarVisible=!0}}}),r("i",{staticClass:"el-icon-delete",on:{click:function(a){return a.stopPropagation(),e.handleRemoveAvatar(a)}}})]):e._e()]):r("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]),e.winWidth>500?r("ul",{staticClass:"upload-tip"},[r("li",[e._v("每次只能上传1张图片。")]),r("li",[e._v("每张图片大小不超过 200kb。")]),r("li",[e._v("文件必须是 jpg 、png 或 jpeg 格式的图片。")])]):e._e(),r("el-dialog",{attrs:{visible:e.avatarVisible,width:"35%","append-to-body":""},on:{"update:visible":function(a){e.avatarVisible=a}}},[r("div",{staticStyle:{"text-align":"center"}},[r("img",{staticStyle:{display:"inline-block",width:"auto","max-width":"100%",height:"600px"},attrs:{src:e.avatarImgUrl,alt:""}})])])],1)])],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{size:"small"},on:{click:function(a){e.dialogVisible=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleSubmitForm}},[e._v("确 定")])],1)],1)],1)},t=[],s=(r("7f7f"),r("cebc")),o=r("75fc"),i=r("4397"),n=r("393b"),u={name:"user",data:function(){var e=this,a=function(a,r,l){""===r||"undefined"===typeof r?l(new Error("请输入密码")):r.length<6?l(new Error("密码不能少于6位")):e.userForm.surePwd?l():(e.$refs.userForm.validateField("surePwd"),l())},r=function(a,r,l){""===r||"undefined"===typeof r?l(new Error("请再次输入密码")):r.length<6?l(new Error("密码不能少于6位")):r!==e.userForm.curPwd?l(new Error("两次密码输入不一致!")):l()},l=function(a,r,l){e.userForm.newPwd||e.userForm.prePwd||e.userForm.confirmPwd?""===r||"undefined"===typeof r?l(new Error("请输入原始密码")):r.length<6?l(new Error("密码不能少于6位")):(e.userForm.newPwd?e.userForm.confirmPwd||e.$refs.userForm.validateField("confirmPwd"):e.$refs.userForm.validateField("newPwd"),l()):l()},t=function(a,r,l){e.userForm.newPwd||e.userForm.prePwd||e.userForm.confirmPwd?""===r||"undefined"===typeof r?l(new Error("请输入新密码")):r.length<6?l(new Error("密码不能少于6位")):(e.$refs.userForm.validateField("confirmPwd"),l()):l()},s=function(a,r,l){e.userForm.newPwd||e.userForm.prePwd||e.userForm.confirmPwd?""===r||"undefined"===typeof r?l(new Error("请再次输入密码")):r.length<6?l(new Error("密码不能少于6位")):e.userForm.newPwd?r!==e.userForm.newPwd?l(new Error("两次密码输入不一致!")):(e.userForm.prePwd||e.$refs.userForm.validateField("prePwd"),l()):(e.$refs.userForm.validateField("newPwd"),l()):l()},o=i["a"].userTypes;return{keyword:"",userTypes:o,role:"",tableData:[],userForm:{_id:"",username:"",curPwd:"",surePwd:"",prePwd:"",newPwd:"",confirmPwd:"",role:"",desc:""},userFormRules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"},{required:!0,message:"请输入用户名",trigger:"change"}],curPwd:[{validator:a,trigger:"blur"},{validator:a,trigger:"change"}],surePwd:[{validator:r,trigger:"blur"},{validator:r,trigger:"change"}],prePwd:[{validator:l,trigger:"change"}],newPwd:[{validator:t,trigger:"change"}],confirmPwd:[{validator:s,trigger:"change"}],role:[{required:!0,message:"请选择用户角色",trigger:"change"}],desc:[{required:!0,message:"请输入用户描述",trigger:"blur"},{required:!0,message:"请输入用户描述",trigger:"change"}]},currentPage:1,pageSize:10,total:0,loading:!1,dialogVisible:!1,dialogType:1,fileObj:null,avatarImgUrl:"",avatarVisible:!1,avatarImgHover:!1}},created:function(){this._getUser()},filters:{formatterTime:n["a"]},methods:{handleRemoveAvatar:function(){this.avatarImgUrl=""},formatterRole:function(e,a,r,l){return"1"===r?"用户":"2"===r?"管理员":"3"===r?"超级管理员":void 0},_getUser:function(){var e=this;this.loading=!0,this.$store.dispatch("user/getUser",{currentPage:this.currentPage,pageSize:this.pageSize,keyword:this.keyword,role:this.role}).then(function(a){a.success?(e.tableData=Object(o["a"])(a.data.list),e.total=a.data.pagination.total,e.pageSize=a.data.pagination.pageSize,e.currentPage=a.data.pagination.currentPage):e.$message.error(a.msg)}).then(function(){e.loading=!1})},handleSizeChange:function(e){this.pageSize=e,this._getUser()},handleCurrentChange:function(e){this.currentPage=e,this._getUser()},handleClick:function(e){console.log(e)},handleAdd:function(){var e=this;this.userForm=Object.assign({},{_id:"",username:"",curPwd:"",prePwd:"",newPwd:"",confirmPwd:"",role:"",desc:""}),this.avatarImgUrl="",this.$nextTick(function(){e.$refs["userForm"].clearValidate()}),this.dialogType=1,this.dialogVisible=!0},handleEdit:function(e){var a=this;this.userForm=Object(s["a"])({},e),this.avatarImgUrl="".concat(this.reUrl).concat(e.avatar),this.$nextTick(function(){a.$refs["userForm"].clearValidate()}),this.dialogType=2,this.dialogVisible=!0},beforeAvatarUpload:function(e){return e.size>2e5?(this.$message({message:"文件".concat(e.name,"太大，不能超过 200kb"),type:"warning"}),!1):(console.log(e),this.avatarImgUrl=URL.createObjectURL(e),this.fileObj=e,!1)},handleSubmitForm:function(){var e=this;this.$refs.userForm.validate(function(a){if(a){var r=new FormData;r.append("file",e.fileObj),r.append("username",e.userForm.username),r.append("role",e.userForm.role),r.append("desc",e.userForm.desc);var l="";e.userForm._id?(l="user/putUser",r.append("_id",e.userForm._id),e.userForm.prePwd&&(r.append("prePwd",e.userForm.prePwd),r.append("newPwd",e.userForm.newPwd),r.append("surePwd",e.userForm.confirmPwd))):(l="user/postUser",r.append("curPwd",e.userForm.curPwd),r.append("surePwd",e.userForm.surePwd)),e.$store.dispatch(l,r).then(function(a){a.success?(e.fileObj=null,e.dialogVisible=!1,e.$message({message:a.msg,type:"success"}),e._getUser()):e.$message({message:a.msg,type:"error"})})}})},handleDelete:function(e){var a=this;this.$confirm("此操作将删除该行, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.$store.dispatch("user/deleteUser",e._id).then(function(e){e.success?(a.$message.success(e.msg),a._getUser()):a.$message.error(e.msg)})}).catch(function(){console.log("取消删除")})}}},c=u,d=(r("035f"),r("2877")),m=Object(d["a"])(c,l,t,!1,null,"52afb346",null);a["default"]=m.exports},e844:function(e,a,r){}}]);