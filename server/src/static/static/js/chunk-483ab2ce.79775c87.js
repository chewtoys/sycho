(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-483ab2ce"],{1658:function(e,t,a){},"2b92":function(e,t,a){"use strict";var l=a("1658"),i=a.n(l);i.a},4397:function(e,t,a){"use strict";var l={linkTypes:[{value:"0",label:"全部"},{value:"1",label:"技术"},{value:"2",label:"生活"},{value:"3",label:"购物"},{value:"4",label:"前端"},{value:"6",label:"小程序"},{value:"7",label:"后端"},{value:"8",label:"友链"},{value:"9",label:"个人项目"}],userTypes:[{value:"0",label:"全部"},{value:"1",label:"用户"},{value:"2",label:"管理员"},{value:"3",label:"超级管理员"}],articleTypes:[{value:"0",label:"全部"},{value:"1",label:"技术"},{value:"2",label:"生活"}],articleTags:[{value:"0",label:"全部"},{value:"1",label:"css3"},{value:"2",label:"sass/less"},{value:"3",label:"html5"},{value:"4",label:"javascript"},{value:"5",label:"es6"},{value:"6",label:"canvas"},{value:"7",label:"pixijs"},{value:"8",label:"createjs"},{value:"9",label:"vue"},{value:"10",label:"vuex"},{value:"11",label:"vue-router"},{value:"12",label:"nuxt"},{value:"13",label:"微信小程序"},{value:"14",label:"wepy"},{value:"15",label:"uniapp"},{value:"16",label:"hybird app"},{value:"17",label:"nginx"},{value:"18",label:"webpack"},{value:"19",label:"express"},{value:"20",label:"koa2"},{value:"21",label:"nodejs"},{value:"22",label:"mongodb"},{value:"23",label:"人生"},{value:"24",label:"随记"},{value:"25",label:"情感"},{value:"26",label:"生活"},{value:"27",label:"工作"},{value:"28",label:"旅游"},{value:"29",label:"烹饪"},{value:"30",label:"运动"},{value:"31",label:"电影"},{value:"32",label:"音乐"},{value:"33",label:"游戏"},{value:"34",label:"吃喝玩乐"}]};t["a"]=l},"491d":function(e,t,a){"use strict";var l=a("c995"),i=a.n(l);i.a},8256:function(e,t,a){"use strict";var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"tinymce-container",class:{fullscreen:e.fullscreen},style:{width:e.containerWidth}},[a("textarea",{staticClass:"tinymce-textarea",attrs:{id:e.tinymceId}}),a("div",{staticClass:"editor-custom-btn-container"},[a("editorImage",{staticClass:"editor-upload-btn",attrs:{color:"#1890ff"},on:{successCBK:e.imageSuccessCBK}})],1)])},i=[],n=(a("ac6a"),a("c5f6"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"upload-container"},[a("el-dialog",{attrs:{title:"内容图片上传",visible:e.uploadDialog,width:"50%","close-on-click-modal":!1},on:{"update:visible":function(t){e.uploadDialog=t}}},[a("div",{staticClass:"upload-box"},[a("el-upload",{ref:"upload",staticClass:"editor-upload",attrs:{action:"",multiple:!0,"file-list":e.fileList,"show-file-list":!0,limit:10,accept:".jpg, .jpeg, .png","list-type":"picture-card","http-request":e.handleUpload,"auto-upload":!0,"before-upload":e.beforeUpload,"on-preview":e.handlePreview,"on-remove":e.handleRemove,"on-exceed":e.handleExceed}},[a("i",{staticClass:"el-icon-plus"}),a("div",{attrs:{slot:"tip"},slot:"tip"},[e._v("文件格式必须是 jpg 、png 或 jpeg，每次只能同时上传5张，且每张不超过 500kb的图片。")]),a("el-dialog",{attrs:{visible:e.previewInUploadDialog,width:"35%","append-to-body":""},on:{"update:visible":function(t){e.previewInUploadDialog=t}}},[a("div",{staticStyle:{"text-align":"center"}},[a("img",{staticStyle:{display:"inline-block",width:"auto","max-width":"100%",height:"600px"},attrs:{src:e.previewPic,alt:""}})])])],1)],1),a("el-button",{on:{click:function(t){e.uploadDialog=!1}}},[e._v("\n      取 消\n    ")]),a("el-button",{attrs:{type:"primary"},on:{click:e.handleSubmit}},[e._v("\n      确 定\n    ")])],1)],1)}),s=[],r=(a("7f7f"),a("456d"),{name:"EditorSlideUpload",props:{color:{type:String,default:"#1890ff"}},data:function(){return{previewDialog:!1,uploadDialog:!1,listObj:{},fileList:[],fileArray:[],formData:null,previewInUploadDialog:!1,previewPic:""}},methods:{checkAllSuccess:function(){var e=this;return Object.keys(this.listObj).every(function(t){return e.listObj[t].hasSuccess})},handleSubmit:function(){var e=this,t=Object.keys(this.listObj).map(function(t){return e.listObj[t]});this.checkAllSuccess()?(this.$emit("successCBK",t),this.listObj={},this.fileList=[],this.uploadDialog=!1):this.$message("请等待所有图片上传成功 或 出现了网络问题，请刷新页面重新上传！")},handlePreview:function(e){this.previewPic=e.url,this.previewDialog=!0},handleExceed:function(e,t){this.$message({message:"上传选择图片数太多啦~",type:"warning"})},handleRemove:function(e){console.log(e);for(var t=e.uid,a=Object.keys(this.listObj),l=0,i=a.length;l<i;l++)if(this.listObj[a[l]].uid===t)return console.log(this.listObj[a[l]]),this.$store.dispatch("article/removeArticlePics",{url:this.listObj[a[l]].preUrl}).then(function(e){console.log(e)}),void delete this.listObj[a[l]]},handleUpload:function(e){var t=this;console.log(this.$refs.upload);var a=new FormData;a.append("file",e.file),console.log(this.$refs.upload.uploadFiles),this.$store.dispatch("article/uploadArticlePics",a).then(function(a){console.log(a),a.success&&(t.listObj[e.file.uid].url="".concat(t.reUrl).concat(a.data[0].url),t.listObj[e.file.uid].preUrl=a.data[0].url,t.listObj[e.file.uid].hasSuccess=!0)})},beforeUpload:function(e){var t=this;return e.size>5e5?(this.$message({message:"文件".concat(e.name,"太大，不能超过 500kb"),type:"warning"}),!1):new Promise(function(a,l){console.log(1),t.formData=new FormData,t.listObj[e.uid]={hasSuccess:!1,uid:e.uid,width:t.width,height:t.height},a(!0)})}}}),o=r,c=(a("2b92"),a("2877")),u=Object(c["a"])(o,n,s,!1,null,"1400d721",null),d=u.exports,m=["advlist anchor autolink autosave code codesample colorpicker colorpicker contextmenu directionality emoticons fullscreen hr image imagetools insertdatetime link lists media nonbreaking noneditable pagebreak paste preview print save searchreplace spellchecker tabfocus table template textcolor textpattern visualblocks visualchars wordcount"],p=m,h=["searchreplace bold italic underline strikethrough alignleft aligncenter alignright outdent indent  blockquote undo redo removeformat subscript superscript code codesample","hr bullist numlist link image charmap preview anchor pagebreak insertdatetime media table emoticons forecolor backcolor fullscreen"],v=h,b=(a("ac4d"),a("8a81"),[]);function f(){return window.tinymce}var g=function(e,t){var a=document.getElementById(e),l=t||function(){};if(!a){var i=document.createElement("script");i.src=e,i.id=e,document.body.appendChild(i),b.push(l);var n="onload"in i?s:r;n(i)}function s(t){t.onload=function(){this.onerror=this.onload=null;for(var e=0,a=b;e<a.length;e++){var l=a[e];l(null,t)}b=null},t.onerror=function(){this.onerror=this.onload=null,l(new Error("Failed to load "+e),t)}}function r(e){e.onreadystatechange=function(){if("complete"===this.readyState||"loaded"===this.readyState){this.onreadystatechange=null;var t=!0,a=!1,l=void 0;try{for(var i,n=b[Symbol.iterator]();!(t=(i=n.next()).done);t=!0){var s=i.value;s(null,e)}}catch(r){a=!0,l=r}finally{try{t||null==n.return||n.return()}finally{if(a)throw l}}b=null}}}a&&l&&(f()?l(null,a):b.push(l))},y=g,w="https://cdn.jsdelivr.net/npm/tinymce-all-in-one@4.9.3/tinymce.min.js",k={name:"Tinymce",components:{editorImage:d},props:{id:{type:String,default:function(){return"vue-tinymce-"+ +new Date+(1e3*Math.random()).toFixed(0)}},value:{type:String,default:""},toolbar:{type:Array,required:!1,default:function(){return[]}},menubar:{type:String,default:"file edit insert view format table"},height:{type:[Number,String],required:!1,default:360},width:{type:[Number,String],required:!1,default:"auto"}},data:function(){return{hasChange:!1,hasInit:!1,tinymceId:this.id,fullscreen:!1,languageTypeList:{en:"en",zh:"zh_CN"}}},computed:{containerWidth:function(){var e=this.width;return/^[\d]+(\.[\d]+)?$/.test(e)?"".concat(e,"px"):e}},watch:{value:function(e){var t=this;!this.hasChange&&this.hasInit&&this.$nextTick(function(){return window.tinymce.get(t.tinymceId).setContent(e||"")})}},mounted:function(){this.init()},activated:function(){window.tinymce&&this.initTinymce()},deactivated:function(){this.destroyTinymce()},destroyed:function(){this.destroyTinymce()},methods:{init:function(){var e=this;y(w,function(t){t?e.$message.error(t.message):e.initTinymce()})},initTinymce:function(){var e=this,t=this;window.tinymce.init({selector:"#".concat(this.tinymceId),language:this.languageTypeList["zh"],height:this.height,body_class:"panel-body ",object_resizing:!1,toolbar:this.toolbar.length>0?this.toolbar:v,menubar:this.menubar,plugins:p,end_container_on_empty_block:!0,powerpaste_word_import:"clean",code_dialog_height:450,code_dialog_width:1e3,advlist_bullet_styles:"square",advlist_number_styles:"default",imagetools_cors_hosts:["www.tinymce.com","codepen.io"],default_link_target:"_blank",link_title:!1,nonbreaking_force_tab:!0,init_instance_callback:function(a){t.value&&a.setContent(t.value),t.hasInit=!0,a.on("NodeChange Change KeyUp SetContent",function(){e.hasChange=!0,e.$emit("input",a.getContent())})},setup:function(e){e.on("FullscreenStateChanged",function(e){t.fullscreen=e.state})}})},destroyTinymce:function(){var e=window.tinymce.get(this.tinymceId);this.fullscreen&&e.execCommand("mceFullScreen"),e&&e.destroy()},setContent:function(e){window.tinymce.get(this.tinymceId).setContent(e)},getContent:function(){window.tinymce.get(this.tinymceId).getContent()},imageSuccessCBK:function(e){var t=this;e.forEach(function(e){window.tinymce.get(t.tinymceId).insertContent('<img class="wscnph" src="'.concat(e.url,'" >'))})}}},F=k,_=(a("ac48"),Object(c["a"])(F,l,i,!1,null,"423ae1f8",null));t["a"]=_.exports},"8aad":function(e,t,a){},ac48:function(e,t,a){"use strict";var l=a("8aad"),i=a.n(l);i.a},c995:function(e,t,a){},fbee:function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"edit"},[a("div",{staticClass:"v-container"},[a("div",{staticClass:"v-header"},[a("el-row",[a("span",[e._v("标题：")]),a("el-input",{staticStyle:{width:"81.8%"},attrs:{placeholder:"请输入标题",clearable:""},model:{value:e.articleForm.title,callback:function(t){e.$set(e.articleForm,"title",t)},expression:"articleForm.title"}})],1),a("el-row",{staticStyle:{display:"flex","align-items":"center"}},[a("span",[e._v("描述：")]),a("el-input",{staticStyle:{width:"81.8%"},attrs:{placeholder:"请输入描述",type:"textarea",rows:2,clearable:""},model:{value:e.articleForm.desc,callback:function(t){e.$set(e.articleForm,"desc",t)},expression:"articleForm.desc"}})],1),a("el-row",{attrs:{type:"flex",align:"middle"}},[a("el-col",{attrs:{span:4}},[a("span",[e._v("作者：")]),a("el-input",{staticStyle:{width:"75%"},attrs:{placeholder:"请输入作者",clearable:""},model:{value:e.articleForm.author,callback:function(t){e.$set(e.articleForm,"author",t)},expression:"articleForm.author"}})],1),a("el-col",{attrs:{span:4}},[a("span",[e._v("分类：")]),a("el-select",{attrs:{clearable:"",placeholder:"请选择文章类别"},model:{value:e.articleForm.type,callback:function(t){e.$set(e.articleForm,"type",t)},expression:"articleForm.type"}},e._l(e.articleTypes,function(e,t){return a("el-option",{directives:[{name:"show",rawName:"v-show",value:0!==t,expression:"index !== 0"}],key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),a("el-col",{attrs:{span:13}},[a("span",[e._v("标签：")]),a("el-select",{staticStyle:{width:"90%"},attrs:{multiple:"",clearable:"",placeholder:"请选择文章标签"},model:{value:e.articleForm.tag,callback:function(t){e.$set(e.articleForm,"tag",t)},expression:"articleForm.tag"}},e._l(e.articleTags,function(e){return a("el-option",{directives:[{name:"show",rawName:"v-show",value:"0"!==e.value,expression:"item.value !== '0'"}],key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1),a("el-row",{attrs:{type:"flex",align:"middle"}},[a("el-col",{attrs:{span:4}},[a("span",[e._v("文章状态：")]),a("el-radio",{attrs:{label:"1"},model:{value:e.articleForm.state,callback:function(t){e.$set(e.articleForm,"state",t)},expression:"articleForm.state"}},[e._v("发布")]),a("el-radio",{attrs:{label:"2"},model:{value:e.articleForm.state,callback:function(t){e.$set(e.articleForm,"state",t)},expression:"articleForm.state"}},[e._v("草稿")])],1),a("el-col",{attrs:{span:4}},[a("span",[e._v("是否公开：")]),a("el-radio",{attrs:{label:"1"},model:{value:e.articleForm.publish,callback:function(t){e.$set(e.articleForm,"publish",t)},expression:"articleForm.publish"}},[e._v("公开")]),a("el-radio",{attrs:{label:"2"},model:{value:e.articleForm.publish,callback:function(t){e.$set(e.articleForm,"publish",t)},expression:"articleForm.publish"}},[e._v("私密")])],1),a("el-col",{attrs:{span:4}},[a("span",[e._v("点赞数：")]),a("el-input-number",{attrs:{min:0,max:1e8,label:"请输入点赞数","controls-position":"right"},model:{value:e.articleForm.likes,callback:function(t){e.$set(e.articleForm,"likes",t)},expression:"articleForm.likes"}})],1),a("el-col",{attrs:{span:4}},[a("span",[e._v("吐槽数：")]),a("el-input-number",{attrs:{min:0,max:1e8,label:"请输入吐槽数","controls-position":"right"},model:{value:e.articleForm.dislikes,callback:function(t){e.$set(e.articleForm,"dislikes",t)},expression:"articleForm.dislikes"}})],1),a("el-col",{attrs:{span:4}},[a("span",[e._v("浏览数：")]),a("el-input-number",{attrs:{min:0,max:1e8,label:"请输入浏览数","controls-position":"right"},model:{value:e.articleForm.views,callback:function(t){e.$set(e.articleForm,"views",t)},expression:"articleForm.views"}})],1)],1),a("el-row",{attrs:{type:"flex",align:"middle"}},[a("el-col",{staticStyle:{display:"flex","align-items":"center"},attrs:{span:12}},[a("span",[e._v("缩略图：")]),a("el-upload",{staticClass:"avatar-uploader",attrs:{action:"","show-file-list":!1,accept:".jpg, .jpeg, .png",limit:1,"before-upload":e.beforeThumbUpload}},[e.thumbImgUrl?a("div",{class:["avatar-box",{hover:e.thumbImgHover}],on:{mouseenter:function(t){e.thumbImgHover=!0},mouseleave:function(t){e.thumbImgHover=!1}}},[a("img",{staticClass:"avatar",attrs:{src:e.thumbImgUrl}}),e.thumbImgHover?a("div",{staticClass:"imgHoverBtns"},[a("i",{staticClass:"el-icon-zoom-in",on:{click:function(t){t.stopPropagation(),e.thumbVisible=!0}}}),a("i",{staticClass:"el-icon-delete",on:{click:function(t){return t.stopPropagation(),e.handleThumbRemove(t)}}})]):e._e()]):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]),a("ul",{staticClass:"upload-tip"},[a("li",[e._v("每次只能上传1张图片。")]),a("li",[e._v("每张图片大小不超过 200kb。")]),a("li",[e._v("文件必须是 jpg 、png 或 jpeg 格式的图片。")])]),a("el-dialog",{attrs:{visible:e.thumbVisible,width:"35%"},on:{"update:visible":function(t){e.thumbVisible=t}}},[a("div",{staticStyle:{"text-align":"center"}},[a("img",{staticStyle:{display:"inline-block",width:"auto","max-width":"100%",height:"600px"},attrs:{src:e.thumbImgUrl,alt:""}})])])],1)],1)],1),a("div",{staticClass:"v-body"},[a("el-row",[a("tinymce",{attrs:{height:460},model:{value:e.articleForm.content,callback:function(t){e.$set(e.articleForm,"content",t)},expression:"articleForm.content"}})],1)],1),a("div",{staticClass:"v-footer"},[a("el-row",[a("el-button",{attrs:{type:"primary"},on:{click:e.handleSubmit}},[e._v("保存")])],1)],1)])])},i=[],n=(a("ac4d"),a("8a81"),a("ac6a"),a("7f7f"),a("28a5"),a("cebc")),s=a("8256"),r=a("4397"),o={name:"edit",data:function(){var e=r["a"].articleTypes,t=r["a"].articleTags;return{articleTypes:e,articleTags:t,articleForm:{_id:"",title:"",desc:"",author:"",type:"",tag:[],state:"1",publish:"1",content:"",views:0,likes:0,dislikes:0,comments:0},fileObj:null,thumbImgUrl:"",thumbVisible:!1,thumbImgHover:!1}},computed:{},created:function(){this._getArticleById()},mounted:function(){this.$nextTick(function(){})},destroyed:function(){},methods:{_getArticleById:function(){var e=this;this.$store.dispatch("article/getArticleById",{_id:this.$route.params.id}).then(function(t){t.success?(e.articleForm=Object(n["a"])({},t.data),e.articleForm.tag=t.data.tag.split(","),e.articleForm.type=String(t.data.type),e.articleForm.state=String(t.data.state),e.articleForm.publish=String(t.data.publish),e.thumbImgUrl="".concat(e.reUrl).concat(t.data.thumb)):e.$message({message:t.msg,type:"error"})})},beforeThumbUpload:function(e){return e.size>2e5?(this.$message.warning("文件".concat(e.name,"太大，不能超过 200kb")),!1):(this.thumbImgUrl=URL.createObjectURL(e),this.fileObj=e,!1)},handleThumbRemove:function(){this.thumbImgUrl="",this.fileObj=null},handleSubmit:function(){var e=this;if(this.checkArticle()){var t=new FormData;t.append("file",this.fileObj),t.append("_id",this.articleForm._id),t.append("title",this.articleForm.title),t.append("desc",this.articleForm.desc),t.append("author",this.articleForm.author),t.append("type",this.articleForm.type),t.append("state",this.articleForm.state),t.append("tag",this.articleForm.tag),t.append("publish",this.articleForm.publish),t.append("content",this.articleForm.content),t.append("views",this.articleForm.views),t.append("likes",this.articleForm.likes),t.append("dislikes",this.articleForm.dislikes),t.append("comments",this.articleForm.comments);var a=[],l=!0,i=!1,n=void 0;try{for(var s,r=this.articleForm.tag[Symbol.iterator]();!(l=(s=r.next()).done);l=!0){var o=s.value,c=!0,u=!1,d=void 0;try{for(var m,p=this.articleTags[Symbol.iterator]();!(c=(m=p.next()).done);c=!0){var h=m.value;o==h.value&&a.push(h.label)}}catch(v){u=!0,d=v}finally{try{c||null==p.return||p.return()}finally{if(u)throw d}}}}catch(v){i=!0,n=v}finally{try{l||null==r.return||r.return()}finally{if(i)throw n}}t.append("tagDesc",a),this.$store.dispatch("article/putArticle",t).then(function(t){t.success?(e.$message.success("修改成功！"),setTimeout(function(){e.$router.push({path:"/article/list"})},500)):e.$message.error(t.msg)})}},checkArticle:function(){return this.articleForm.title.trim()?this.articleForm.desc.trim()?this.articleForm.author.trim()?this.articleForm.type?this.articleForm.tag.length?!!this.articleForm.content.trim()||(this.$message.error("请输入文章内容"),!1):(this.$message.error("请选择文章标签"),!1):(this.$message.error("请选择文章类型"),!1):(this.$message.error("请输入作者"),!1):(this.$message.error("请输入描述"),!1):(this.$message.error("请输入标题"),!1)}},components:{tinymce:s["a"]}},c=o,u=(a("491d"),a("2877")),d=Object(u["a"])(c,l,i,!1,null,"e8195544",null);t["default"]=d.exports}}]);
//# sourceMappingURL=chunk-483ab2ce.79775c87.js.map